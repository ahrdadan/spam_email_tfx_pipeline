# Submission 1: Proyek Pengembangan Machine Learning Pipeline

Nama: Ahmad Ramadhan \
Username dicoding: dhadhan \
Email: ahmad.ramadhan@live.jp

|                         | Deskripsi                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| ----------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Dataset                 | _[Email Spam Detection](https://www.kaggle.com/datasets/ashfakyeafi/spam-email-classification)_                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Masalah                 | Email spam merupakan pesan-pesan yang tidak diinginkan yang dikirimkan secara massal kepada pengguna email dengan tujuan untuk mempromosikan produk, layanan, atau untuk _Cybercrime_ yang dapat merugikan pengguna email itu sendiri. Sehingga pengguna dituntut untuk mensortir email tersebut secara manual. Masalah selanjutnya adalah email spam tersebut terlalu banyak dan bercamour dengan email yang bukan spam. Dibutuhkan solusi digital untuk secara menghapus email spam tersebut secara otomatis.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |
| Solusi machine learning | Solusi yang diberikan adalah dengan menggunakan Machine Learning untuk mendeteksi apakah email tersebut spam atau bukan. Dengan adanya model deteksi email spam, pengguna akan mengalami peningkatan produktivitas karena tidak perlu lagi memilah-milah dan membuang waktu. Dan juga model deteksi email spam dapat membantu pengguna mengurangi risiko keamanan terkait dengan menerima dan membuka email yang mengandung _malware, phising_, atau penipuan lainnya. Dengan mencegah email spam masuk ke kotak masuk pengguna, solusi ini membantu melindungi data sensitif dan informasi pribadi dari ancaman _cyber_.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
| Metode pengolahan       | Metode yang dipakai adalah dengan mempelajari karakteristik dari email spam dan bukan spam yang diberi nilai 1 untuk email Spam dan 0 untuk email yang bukan spam. data yang digunakan meliputi tokenisasi teks email, pembersihan teks dengan menghapus kolom yang tidak dibutuhkan dan juga penggunaan teknik pengkodean seperti `TF-IDF` atau `word embeddings` untuk merepresentasikan teks ke dalam bentuk _numerik_, dan pembagian dataset menjadi data `train` & `val`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
| Arsitektur model        | Arsitektur model yang digunakan adalah sebagai berikut: <br><li> `Input Layer`: _Layer_ ini menerima input dalam bentuk teks email yang akan diproses. Teks kemudian akan diubah menjadi representasi numerik agar dapat dimengerti oleh model. </li><br/><li> `Layer Processing Text`: _Layer_ ini bertugas untuk mengubah teks menjadi representasi numerik. Hal ini dilakukan dengan memanfaatkan teknik seperti _tokenisasi_, pembersihan teks, dan pengkodean teks ke dalam bilangan bulat. Representasi numerik dari teks ini akan digunakan sebagai input untuk _layer_ selanjutnya. </li><br><li> `Embedding Layer`: _layer_ ini menerjemahkan representasi numerik teks ke dalam ruang _vektor_ yang lebih rendah dimensi. Ini membantu model untuk mempelajari representasi yang lebih baik dari teks, dengan mempertahankan struktur dan hubungan antar kata-kata. </li><br><li> `Rekuren Layer (RNN)`: Model menggunakan _layer_ LSTM atau GRU untuk memahami urutan kata-kata dalam teks. Lapisan ini memungkinkan model untuk memahami konteks dan urutan kata-kata dalam teks email, yang sering kali penting untuk mendeteksi apakah email tersebut spam atau bukan. </li><br><li> `Fully Connected Layers`: Lapisan-lapisan ini bertanggung jawab untuk menggabungkan fitur-fitur yang dipelajari oleh lapisan sebelumnya dan melakukan klasifikasi apakah email tersebut spam atau bukan. Dengan menggunakan fungsi aktivasi sigmoid pada lapisan output, model mengeluarkan probabilitas bahwa sebuah email adalah spam.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |
| Metrik evaluasi         | Metrik-metrik evaluasi yang digunakan untuk mengevaluasi performa model dalam kedua _script_ adalah sebagai berikut: <ol><li>`Binary Accuracy`: Metrik ini mengukur akurasi prediksi model untuk klasifikasi biner (spam atau bukan spam). Akurasi dihitung sebagai jumlah prediksi yang benar (positif dan negatif) dibagi dengan jumlah total sampel.</li><li>`Binary Crossentropy Loss`: Metrik ini mengukur seberapa baik model dalam membedakan antara kelas spam dan bukan spam dengan menggunakan fungsi kerugian _binary crossentropy_. Semakin rendah nilai _binary crossentropy_, semakin baik model dalam melakukan klasifikasi.</li><li>`Early Stopping`: _Callback_ ini digunakan untuk menghentikan pelatihan lebih awal jika tidak terjadi peningkatan dalam metrik evaluasi (misalnya: akurasi validasi) dalam beberapa epoch berturut-turut. Ini membantu mencegah _overfitting_ dan mempercepat proses pelatihan.</li><li>`Model Checkpoint`: _Callback_ ini digunakan untuk menyimpan model terbaik selama pelatihan berdasarkan metrik evaluasi tertentu (misalnya: akurasi validasi). Model yang disimpan dapat digunakan kembali nantinya tanpa harus menjalankan pelatihan dari awal. </li></ol><br> Pada Metrik ini saya juga menggunakan tools _evaluator_ sebagai berikut:<br> <ul><li>`tfma.MetricConfig(class_name='ExampleCount')` </li></li><br><li>`tfma.MetricConfig(class_name='AUC')` </li><br><li>`tfma.MetricConfig(class_name='FalsePositives')` </li><br><li>`tfma.MetricConfig(class_name='TruePositives')`</li><br><li>`tfma.MetricConfig(class_name='FalseNegatives')`</li><br><li>`tfma.MetricConfig(class_name='TrueNegatives')`</li><br><li>Penetapan Ambang Akurasi (`BinaryAccuracy` dengan _threshold_)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Performa model          | Pada model ini terdapat evaluasi modelnya berikut adalah penjelasannya:<br><ul><li>`tfma.MetricConfig(class_name='ExampleCount')`: sederhana saja melacak jumlah total email yang digunakan untuk pelatihan, validasi, dan evaluasi. </li></li><br><li>`tfma.MetricConfig(class_name='AUC')`: menghitung _Area Under the ROC Curve (AUC)_. Ini mencerminkan kemampuan model untuk membedakan email spam dari non-spam di semua ambang klasifikasi. </li><br><li>`tfma.MetricConfig(class_name='FalsePositives')`: menghitung email yang salah diklasifikasikan sebagai spam (kesalahan tipe I). </li><br><li>`tfma.MetricConfig(class_name='TruePositives')`: menghitung email yang benar diklasifikasikan sebagai spam.</li><br><li>`tfma.MetricConfig(class_name='FalseNegatives')`: menghitung email yang salah diklasifikasikan sebagai _non-spam_ (kesalahan tipe II).</li><br><li>`tfma.MetricConfig(class_name='TrueNegatives')`: menghitung email yang benar diklasifikasikan sebagai _non-spam_.</li><br><li>Penetapan Ambang Akurasi (`BinaryAccuracy` dengan _threshold_): Konfigurasi ini menetapkan ambang minimum untuk apa yang merupakan klasifikasi "akurat" sebagai spam. Secara _default_, menggunakan nilai 0.5, artinya model perlu setidaknya 50% yakin sebuah email adalah spam untuk mengklasifikasikannya sebagai spam. </li></ul><br>Berikut adalah hasil dari metrik evaluasinya:<br>![visualisasi evaluator metrik](/Screenshoots/evaluator.png)<br>1. `AUC (Area Under the ROC Curve)`: <br> Nilai Metrik: 0,97891 <br> Keterangan: Nilai _AUC_ yang sangat tinggi ini (mendekati 1) menunjukkan bahwa model tersebut unggul dalam membedakan antara email spam dan non-spam. Ini secara efektif memisahkan dua kelas di semua ambang klasifikasi.<br><br>2. `Binary Accuracy`:<br>Nilai Metrik: 0.98043<br>Keterangan: Model ini mencapai akurasi luar biasa sebesar 98,04% dalam mengklasifikasikan email sebagai spam atau bukan spam. Artinya, model tersebut hanya menghasilkan sedikit prediksi yang salah.<br><br>3. `Example Count`:<br>Nilai Metrik: 1482<br>Keterangan: Model telah dilatih dan dievaluasi pada kumpulan data 1.482 sampel email. Ukuran sampel ini memberikan representasi distribusi data yang masuk akal untuk mengevaluasi performa model.<br><br>4. `False Negatives`:<br>Nilai Metrik: 21.00000<br>Keterangan: Model salah mengklasifikasikan 21 email sebagai bukan spam padahal sebenarnya merupakan spam (kesalahan Tipe II). Ini mewakili tingkat Negatif Palsu sebesar 1,41%.<br><br>5. `False Positives`:<br>Nilai Metrik: 8.00000<br>Keterangan: Nilai kerugian sebesar 0,65578 menunjukkan kesalahan model secara keseluruhan dalam memprediksi kelas yang benar untuk setiap email. Nilai kerugian yang lebih rendah menunjukkan kinerja yang lebih baik.<br><br>6. `Loss`:<br>Nilai Metrik: 0.65578<br>Keterangan: Nilai _loss_ sebesar 0,65578 menunjukkan kesalahan model secara keseluruhan dalam memprediksi kelas yang benar untuk setiap email. Nilai kerugian yang lebih rendah menunjukkan kinerja yang lebih baik.<br><br>7. `True Negatives`:<br>Nilai Metrik: 1283.00000<br>Keterangan: Model mengklasifikasikan 1283 email dengan benar sebagai bukan spam (kelas negatif). Ini mewakili tingkat True Negative sebesar 86,53%.<br><br>8. `True Positives`:<br>Nilai Metrik: 170.00000<br>Keterangan: Model mengklasifikasikan 170 email dengan benar sebagai spam (kelas positif). Ini mewakili tingkat Positif Sejati sebesar 98,82%.<br><br><b>Kesimpulan Keseluruhan</b>:<br>Berdasarkan metrik yang diberikan, model pendeteksian email spam menunjukkan kinerja yang luar biasa untuk model ini. Tingkat `AUC`, `Binary Accuracy`, dan `True Positive/Negative` yang tinggi menunjukkan kemampuan model untuk membedakan secara akurat antara email spam dan non-spam. Rendahnya tingkat `False Positive` dan `False Negative` semakin menyoroti efektivitas model ini dalam meminimalkan kesalahan klasifikasi dan melindungi pengguna dari spam sekaligus menghindari gangguan yang tidak perlu pada kotak masuk mereka. |
| Kesimpulan              | Model yang telah dibangun dan dilatih telah mencapai hasil akurasi yang cukup bagus dan model ini telah dilakukan uji coba pada file `dhadhan-testing.ipynb` dan sudah berhasil mengidentifikasi apakah email tersebut spam atau bukan.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
| Opsi deployment         | Model dideploy dengan memakai platform [Alibaba Cloud](https://www.alibabacloud.com/), kemudian di remote menggunakan _workbench_ bawaan dari _Alibaba Cloud_. Untuk _type cloudnya_ memakai _Elastic Compute Service (ECS)_ dan `OS Centos 7`. Cloud pertama menginstall _package_ yang dibutuhkan seperti **Docker Compose**. Kemudian _Docker Compose_ menjalankan file `compose.yml` yang telah dibuat. Berikut adalah hasil compose up <br>![Compose Up](/Screenshoots/dhadhan-deployment/1%20compose%20up.png) Check hasil **Compose** dengan `docker compose ps` ![Hasil Compose](/Screenshoots/dhadhan-deployment/2%20compose%20ps.png) Kemudian mengijinkan port pada _security instance alibaba_ sesuai dengan yang dibuat pada `compose.yml` ![allow port](/Screenshoots/dhadhan-deployment/3%20add%20rule.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
| Web app                 | [Spam Email Detection Model](http://147.139.204.52:8501/v1/models/spam-email-detection-model)![Model Screenshoots](/Screenshoots/dhadhan-deployment/4%20web%20app.png)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
| Monitoring              | Monitoring pada model ini dilakukan menggunakan `prometheus` sebagai statistiknya dan `grafana` sebagai visualisasinya dalam bentuk **dashboard**.<br> Berikut adalah metrik yang digunakan untuk monitoring dan memvisualisasikannya ke _dashboard_: ![Dashboard](/Screenshoots/dhadhan-grafana-dashboard/3%20result%20dashboard%20with%20grafana.png) <ul><li>`tensorflow:serving:runtime_latency_count` untuk mengukur latensi permintaan ke model yang telah dideploy. Hasilnya adalah model berjalan dengan normal karena saat mengirim `request` ke modelnya hanya beberapakali saja.</li><li>`:tensorflow:core:graph_run_time_usecs`: Mengukur waktu yang dibutuhkan oleh TensorFlow Core untuk menjalankan sebuah _predict_. Kali ini waktu yang dibutuhkan sudah berjalan cukup normal dengan hasil per _request_ **777562ms**.</li><li>`tensorflow:serving:request_latency_count`: Mengukur jumlah _request_ untuk menjalankan modelnya. Hasilnya adalah sesuai dengan jumlah saat dilakukan uji coba, metrik terupdate otomatis dan menunjukkan angka yang benar</li> </ol> Kesimpulan: Dashboard yang dibuat dengan `grafana` sudah menunjukkan statistik yang terupdate dan tampilannya yang banyak pilihannya. Pada metrik yang dibuat kali ini sudah menunjukkan hasil yang optimal sesuai dengan type cloud yang dipakai.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |

---
